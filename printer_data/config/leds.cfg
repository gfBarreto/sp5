[gcode_macro leds_esquerda]
description: Acende os 25 LEDs sequencialmente com várias cores
gcode:
    {% for i in range(1, 25) %}
      SET_LED LED=leds INDEX={i} RED=1.0 GREEN=0.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(1, 25) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=1.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(1, 25) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P50
    {% endfor %}
    SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0

[gcode_macro leds_direita]
description: Acende os 25 LEDs sequencialmente com várias cores
gcode:
    {% for i in range(26, 50) %}
      SET_LED LED=leds INDEX={i} RED=1.0 GREEN=0.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(26, 50) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=1.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(26, 50) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P50
    {% endfor %}
    SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0

[gcode_macro leds_completo]
description: Acende os 25 LEDs sequencialmente com várias cores
gcode:
    {% for i in range(1, 50) %}
      SET_LED LED=leds INDEX={i} RED=1.0 GREEN=0.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(1, 50) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=1.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(1, 50) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P50
    {% endfor %}
    SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0

[gcode_macro LED_LARANJA]
description: Laranja sequencial – simula aquecimento com onda lenta
gcode:
    {% for i in range(1, 51) %}
      SET_LED LED=leds INDEX={i} RED=1.0 GREEN=0.3 BLUE=0.0
      G4 P30
    {% endfor %}
    G4 P500

[gcode_macro LED_HOMING]
description: Azul espelhado – preenchimento simultâneo dos lados
gcode:
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={1 + i} RED=0.0 GREEN=0.0 BLUE=1.0
      SET_LED LED=leds INDEX={50 - i} RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P20
    {% endfor %}

[gcode_macro LED_CANCEL]
description: Pisca todos os LEDs em vermelho – cancelamento
gcode:
    {% for j in range(0, 4) %}
      SET_LED LED=leds RED=1.0 GREEN=0.0 BLUE=0.0
      G4 P200
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0
      G4 P200
    {% endfor %}

[gcode_macro LED_BRANCO]
description: Branco espelhado – início da impressão
gcode:
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={1 + i} RED=1.0 GREEN=1.0 BLUE=1.0
      SET_LED LED=leds INDEX={50 - i} RED=1.0 GREEN=1.0 BLUE=1.0
      G4 P10
    {% endfor %}

[gcode_macro LED_ENDPRINT]
description: Efeito verde gradiente ao final da impressão
gcode:
    {% for i in range(1, 51) %}
      {% set brilho = 0.1 + (i / 50.0 * 0.9) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN={brilho|round(3)} BLUE=0.0
      G4 P10
    {% endfor %}
    {% set steps = [0.3, 0.6, 1.0, 0.6, 0.3] %}
    {% for _ in range(3) %}
      {% for v in steps %}
        SET_LED LED=leds RED=0.0 GREEN={v} BLUE=0.0
        G4 P500
      {% endfor %}
    {% endfor %}
    {% for i in range(50, 0, -1) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=0.0 BLUE=0.0
      G4 P10
    {% endfor %}

[gcode_macro LED_OFF]
description: LEDs desligados – standby ou economia
gcode:
    SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0

[gcode_macro LED_ARCO_IRIS_ESPELHO]
description: Arco-íris suave com efeito espelhado nas duas barras
gcode:
    {% set cores = [
        (1.0, 0.0, 0.0),   # Vermelho
        (1.0, 0.5, 0.0),   # Laranja
        (1.0, 1.0, 0.0),   # Amarelo
        (0.0, 1.0, 0.0),   # Verde
        (0.0, 1.0, 1.0),   # Ciano
        (0.0, 0.0, 1.0),   # Azul
        (0.5, 0.0, 1.0)    # Violeta
    ] %}
    {% for i in range(0, 25) %}
      {% set cor = cores[i % cores|length] %}
      SET_LED LED=leds INDEX={1 + i} RED={cor[0]} GREEN={cor[1]} BLUE={cor[2]}
      SET_LED LED=leds INDEX={50 - i} RED={cor[0]} GREEN={cor[1]} BLUE={cor[2]}
      G4 P25
    {% endfor %}

[gcode_macro LEDS_ESPELHO]
description: Efeito espelhado nas barras de LED com três cores
gcode:
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={1 + i} RED=1.0 GREEN=0.0 BLUE=0.0
      SET_LED LED=leds INDEX={50 - i} RED=1.0 GREEN=0.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={1 + i} RED=0.0 GREEN=1.0 BLUE=0.0
      SET_LED LED=leds INDEX={50 - i} RED=0.0 GREEN=1.0 BLUE=0.0
      G4 P50
    {% endfor %}
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={1 + i} RED=0.0 GREEN=0.0 BLUE=1.0
      SET_LED LED=leds INDEX={50 - i} RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P50
    {% endfor %}
    SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0

[gcode_macro LED_RESPIRAR]
description: Efeito de respiração azul suave
gcode:
    {% for i in range(0, 4) %}
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.3
      G4 P150
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.6
      G4 P150
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P150
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.6
      G4 P150
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.3
      G4 P150
    {% endfor %}

[gcode_macro LED_EXPLOSAO]
description: Efeito explosão – do centro para as bordas
gcode:
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={25 - i} RED=1.0 GREEN=0.3 BLUE=0.0
      SET_LED LED=leds INDEX={26 + i} RED=1.0 GREEN=0.3 BLUE=0.0
      G4 P30
    {% endfor %}

[gcode_macro LED_ALERTA]
description: Alerta amarelo piscando rápido
gcode:
    {% for _ in range(4) %}
      SET_LED LED=leds RED=1.0 GREEN=1.0 BLUE=0.0
      G4 P150
      SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0
      G4 P150
    {% endfor %}

[gcode_macro LED_CONTAGEM]
description: Contagem regressiva apagando LEDs de 50 a 1
gcode:
    SET_LED LED=leds RED=1.0 GREEN=0.0 BLUE=0.0
    G4 P200
    {% for i in range(50, 0, -1) %}
      SET_LED LED=leds INDEX={i} RED=0.0 GREEN=0.0 BLUE=0.0
      G4 P30
    {% endfor %}

[gcode_macro LED_GRADIENTE_CROSS]
description: Gradiente cruzado entre barras esquerda e direita
gcode:
    {% for i in range(0, 25) %}
      SET_LED LED=leds INDEX={1 + i} RED=1.0 GREEN=0.0 BLUE=0.0
      SET_LED LED=leds INDEX={50 - i} RED=0.0 GREEN=0.0 BLUE=1.0
      G4 P40
    {% endfor %}
    G4 P500
    SET_LED LED=leds RED=0.0 GREEN=1.0 BLUE=0.0
    G4 P500
    SET_LED LED=leds RED=0.0 GREEN=0.0 BLUE=0.0

[gcode_macro LED_AQUECIMENTO_MESA_PROGRESSIVO]
description: Transição gradual de cor conforme a cama aquece
gcode:
    {% set target = printer.heater_bed.target|float %}
    {% set steps = [
        (1.0, 1.0, 1.0),  # Branco
        (1.0, 1.0, 0.0),  # Amarelo
        (1.0, 0.5, 0.0),  # Laranja
        (1.0, 0.0, 0.0)   # Vermelho
    ] %}
    {% set faixa = target / steps|length %}
    M117 Aguardando cama atingir {target}°C
    {% for i in range(steps|length) %}
      {% set limite = faixa * (i + 1) %}
      {% set cor = steps[i] %}
      SET_LED LED=leds RED={cor[0]} GREEN={cor[1]} BLUE={cor[2]}
      G4 P300
      TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={limite - 1}
    {% endfor %}
    M117 Cama pronta!
